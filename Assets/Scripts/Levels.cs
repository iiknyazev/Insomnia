using System;
using System.Collections.Generic;
using UnityEngine;

public class Levels : MonoBehaviour
{
    public static int CurrentLevel { get; private set; } = -1;
    public static int OpenLevels { get; private set; }

    public static Action NewLevelHasBeenLoaded;

    private static List<string> levels = new List<string>()
    {
        // 1 lvl
                @"
..................
..................
..................
..................
.....@......$.....
..................
..................
..................
..................
",
        // 2 lvl
                @"
..................
..................
...........###....
..........#.......
.....@...#..$.....
..........#...#...
...........###....
..........##......
.......###........
",
        // 3 lvl
                @"
..................
..................
..#####....#####..
##.....#..#.....##
.....@.#..#..$....
##.....#..#.....##
..#####....###..#.
..............##..
..................
",
        // 4 lvl
                @"
.........#..#.....
...####..#...#....
###....#.#....####
.....@.#.#........
###....#..###...##
...####......###..
.........###......
........#.$.#.....
........#...#.....
",
        // 5 lvl
                @"
..................
..................
..#####....#####..
.#.....#..#.....#.
.#.0.@.#..#..$..#.
.#.....#..#.....#.
..#####....###.0#.
..............##..
..................
!
4 3 6 15
",
        // 6 lvl
                @"
..................
...####.....####..
..#....#...#..0.#.
..#..@.#...#0...#.
..#....#....####..
..#.0..#..........
...####..###......
........#$.0#.....
.........###......
!
5 4 2 14
3 12 7 11
",
        // 7 lvl
                @"
..................
..................
..#####....#####..
.#.....####.....#.
.#...@.....~..$.#.
.#.....####.....#.
.#+...#....###..#.
..####........##..
..................
",

        // 8 lvl
                @"
.#....#......##...
.###..#....###....
.#..@.#..###......
.#.####........###
#.........###..#..
#....##.....######
.#....#.##.##.....
.###.#...##.....$.
.#.....#....####..
",
        // 9 lvl
                @"
##....#......##...
.###..#....###....
.#..@.#..###......
.#.####.....#..###
.#........###..#$.
##....#...##..####
.####...##........
.#..#....##.#.....
....###.....####..
",
        // 10 lvl
                @"
.#....#..##..#..#.
##.#..###......#..
..#...#..###.##...
..###......#....##
.#........###..#$.
##..###....#..####
.#.##..####.......
.......@...######.
.#####..##.#.#...#
",
        // 11 lvl
                @"
.#....#...#..#..#.
####..##.....#0#..
.....##..######...
#####....@..#...##
..#...###.#..#....
##..##...###..##.#
.#.##..##0.$#.#...
.....#...###..####
#..###.....#.#....
!
6 9 1 14
",
        // 12 lvl
                @"
##..#.#...#.$#....
.#....#0..####..#.
..#.#.###...#.#...
..#...#..###...#..
.#.0##.@.....#..#.
.###...###....####
.#...##...#..#.#..
#..##.##.#0#...#.0
..#......#..#..#.#
!
4 3 7 17
1 7 7 10
",
        // 13 lvl
                @"
...#..~#.#....#...
.##...#....###0...
..#.##.#......####
#..#....#@........
#.....##.......##.
0.###.#...###....#
.#..#..#.#.+.##..#
#.$..#.#.#.....#..
###..#.#..#~#.#...
!
5 0 1 14
",
        // 14 lvl
                @"
##..#..#.+#..#..#.
.0#.$#.###..##.#..
...##..#..#.0#.#0#
#.#....#.####...#.
##....@...#.......
.0#..###....#.####
.###...###...#0.~.
#.0.#.#...#...####
.##.#...#.#.#....#
!
1 1 2 12
5 1 2 16
7 2 6 14
",
//        // 15 lvl
//                @"
//....#.#...#.$#....
//...#..#0..####..#.
//.#..#.###...#.#...
//..#...#..###...#..
//.#.0##.@.....#..#.
//..##...###....####
//.#...##...#..#.#..
//#..##.##.#0#...#.0
//..#......#..#..#.#
//!
//4 3 7 17
//1 7 7 10
//",
//        // 16 lvl
//                @"
//....#.#...#.$#....
//...#..#0..####..#.
//.#..#.###...#.#...
//..#...#..###...#..
//.#.0##.@.....#..#.
//..##...###....####
//.#...##...#..#.#..
//#..##.##.#0#...#.0
//..#......#..#..#.#
//!
//4 3 7 17
//1 7 7 10
//",
        // 17 lvl
                @"
.#..++.#..#.##.#..
~###..##0#...#.~0.
.#.0@0#.##.0..###.
...####$...#.....#
..#.~..####+####.~
.~#...+#.....0....
..####.#..####..#.
#.0.+..#.#.#.~..##
..##..+...+0...#..
!
2 3 1 8 
2 11 1 16
7 2 5 13
2 5 8 11
"
};

    private void Start()
    {
        OpenLevels = PlayerPrefs.HasKey(PlayerData.OpenLevels) == false
            ? 1
            : PlayerPrefs.GetInt(PlayerData.OpenLevels);
    }

    public static int GetLevelsCount()
    {
        return levels.Count;
    }

    public static string GetLevel(int levelNumber)
    {
        CurrentLevel = levelNumber;
        NewLevelHasBeenLoaded?.Invoke();
        return levels[CurrentLevel];
    }

    public static string NextLevel()
    {
        OpenLevels = OpenLevels != levels.Count ? OpenLevels + 1 : OpenLevels;

        if (CurrentLevel == levels.Count - 1)
        {
            Debug.Log("Конец игры");
            return levels[levels.Count - 1];
        }
        else
        {
            CurrentLevel++;
            NewLevelHasBeenLoaded?.Invoke();
            return levels[CurrentLevel];
        }
    }

    public static string Restart()
    {
        return levels[CurrentLevel];
    }
}
